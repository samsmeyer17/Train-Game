<!DOCTYPE html>

<html lang="en-us">

<head>

  <meta charset="UTF-8">
  <title>Employee Tracker</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  <!-- Moment.js Reference -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>

  <style>
    #employee-table th,
    td {
      display: inline-block;
      width: 16.575%;
    }
  </style>
</head>

<body>

  <!-- Employee Tracker -->
  <div class="container">

    <!-- Jumbotron -->
    <div class="jumbotron" style="background-color: darkblue; color: white;">
      <h1 class="text-center">Oh The Places You'll Go.... On These Trains!</h1>
      <h3 class="text-center">Just Another Train Schedule Though</h3>
    </div>

    <div class="row">

      <div class="col-md-12">

        <!-- Current Employees-->
        <div class="card mb-4">
          <div class="card-header">Current Train Schedule</div>
          <div class="card-body">
            <table class="table table-md table-hover" id='employee-table'>
              <thead>
                <tr>
                  <th scope="col">Train Name</th>
                  <th scope="col">Destination</th>
                  <th scope="col">Frequency</th>
                  <th scope="col">Next Arrival</th>
                  <th scope="col">Minutes Away</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <!-- Add Employee  -->
        <div class="card mb-4">
          <div class="card-header">Add Train</div>
          <div class="card-body">

            <!-- Entry Form -->
            <form>
              <div class="form-group">
                <label for="train-name-input">Train Name</label>
                <input class="form-control" id="train-name-input" placeholder="Sounder" type="text">
              </div>
              <div class="form-group">
                <label for="destination-input">Destination</label>
                <input class="form-control" id="destination-input" placeholder="Seattle" type="text">
              </div>
              <div class="form-group">
                <label for="first-train-input">First Train Time(HH:mm - military time)</label>
                <input class="form-control" id="first-train-input" placeholder="08/07/1996" type="text">
              </div>
              <div class="form-group">
                <label for="frequency-input">Frequency (mm)</label>
                <input class="form-control" id="frequency-input" placeholder="30" type="text">
              </div>
              <button class="btn btn-primary float-right" id="add-train-btn">Submit</button>
            </form>

          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- JavaScript -->
  <script src="../Train-Game/assets/javascript/game.js"></script>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/6.3.5/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-database.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#config-web-app -->

  <script>
  // Your web app's Firebase configuration
    var config = {
      apiKey: "AIzaSyAVsTh-a8XkebmRd_6Lq7g0oQcBjd66fTA",
      authDomain: "train-game-44ffb.firebaseapp.com",
      databaseURL: "https://train-game-44ffb.firebaseio.com",
      projectId: "train-game-44ffb",
      storageBucket: "",
      messagingSenderId: "1002607826901",
      appId: "1:1002607826901:web:e801eaba471c4788"
    };
  // Initialize Firebase
    firebase.initializeApp(config);

    var database = firebase.database();

    // button for adding trains to the train schedule
    $("#add-train-btn").on("click", function(event) {
      event.preventDefault();

      var trainName = $("#train-name-input").val().trim();
      var trainDestination = $("#destination-input").val().trim();
      var firstTime = $("#first-train-input").val().trim();
      var firstTimeConvert = moment(firstTime, "HH:mm");
      var frequency = $("#frequency-input").val().trim();
      var currentTime = moment();
      var nextTime = firstTimeConvert + frequency;
      var nextTimeConvert = moment(nextTime, "HH:mm");

      console.log(firstTimeConvert);

      var newTrain = {
        name: trainName,
        destination: trainDestination,
        firstTime: firstTime,
        frequency: frequency,
        nextTime: nextTime,
      };

      database.ref().push(newTrain);
      
      console.log(newTrain.name);
      console.log(newTrain.destination);
      console.log(newTrain.firstTime);
      console.log(newTrain.frequency);
      console.log(newTrain.nextTime);
    });
  </script>
</body>

</html>